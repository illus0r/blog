---
published: true
title: Плиточная  карта России
permalink: all/plitochnaya-karta-rossii/
---

Коллега прислал ссылку [на конкурс со странным названием.](http://telegra.ph/Konkurs-Raspili-Rossiyu-Na-kvadraty-11-13) Нужно придумать, как разделить Россию на квадратики, чтобы делать клёвые плиточные визуализации. У Америки такая есть:

![]({{site.baseurl}}/media/tilemap-usa.png)
{: .large}

Все штаты-квадратики одного размера, поэтому их данные легко сравнить между собой

Для России такую карту сделать сложнее, потому что её субъекты сильно отличаются размерами:

![]({{site.baseurl}}/media/tilemap-feel-difference.png)

Чтобы прочувствовать проблему, сравните Ингушетию с Сахой
{:.caption}

Кажется, квадратами нарисовать Россию невозможно. Решаю «приблизиться к оленю» и пробую шестиугольную сетку. Рисую графики похожие на настоящие. Придумываю, как сократить названия регионов. Выходит так:

![]({{site.baseurl}}/media/tilemap-hex-1.png)

Я ничего не потеряю, если сделаю тайлы квадратными. График тогда можно увеличить а рамку удалить:

![]({{site.baseurl}}/media/tilemap-rect-1.png)

Оу, теперь можно сдвинуть колонки на полвысоты и получить нормальную квадратную карту. Это круто: ячейки выстраиваются в горизонтальные линии и данные проще сравнивать.

![]({{site.baseurl}}/media/tilemap-rect-2.png)

Показываю [Роме Бунину,](http://revealthedata.com/) ведущему курса о визуализации данных. Кстати, [курс стартует 8 декабря](https://datalaboratory.ru/course/) в Москве, приходите. Можно удалённо.

Рома недоволен:

![]({{site.baseurl}}/media/tilemap-rbunin1.png)

Чтобы сделать карту ближе к России, пробую равномерно надуть восток:

![]({{site.baseurl}}/media/tilemap-rect-twosizes.png)

Чтобы хоть как-то уплотнить карту, убираю горизонтальные отступы:

![]({{site.baseurl}}/media/tilemap-rect-twosizes2.png)

Вышла расчёска :–( Никто не догадается, почему одни регионы рядом а другие далеко. Может разрешить карте быть дырявой? Нет, станет ещё непонятнее.

Пробую гигантские субъекты нарисовать гигантскими:

![]({{site.baseurl}}/media/tilemap-rect-oligomer1.png)

Мало надул, не похоже на Россию. Дуем дальше:

![]({{site.baseurl}}/media/tilemap-rect-oligomer2.png)

Форма похожая, но теперь понятно: нельзя к каким-то двум регионам привлекать столько внимания. Поэтому распиливаю страну по Уралу и показываю европейскую часть крупно. Так в некоторых проектах делает [Лаборатория Данных:](https://datalaboratory.ru/)

![]({{site.baseurl}}/media/tilemap-division.png)

Получается так:

![]({{site.baseurl}}/media/tilemap-rect-cut1.png)

С Сибирью беда. Ямало-Ненецкий и Ханты-Мансийский округа отвалились от Ненецкого. Свердловская область почему-то на севере. Надо ближе половинки сдвинуть, а то непонятно, что это одна страна.

![]({{site.baseurl}}/media/tilemap-division-v1.png)

Нравится, что строки востока и запада не совпадают, это усиливает ощущение разреза. Показываю Роме, он одобряет:

![]({{site.baseurl}}/media/tilemap-rbunin-ok.png)

На радостях рисую римейк [карты с флагами](https://upload.wikimedia.org/wikipedia/commons/6/6b/Flag-maps_of_the_subjects_of_Russia.png).

![]({{site.baseurl}}/media/tilemap-flags.png)
{: .large}

У Сахалина флаг крутой
{:.caption}

В её форме не угадывается Россия, однако, рассматривать интересно. С названиями было бы круче, но уже лень.

Чтобы оценить, точность плиточной карты, раскрашиваю её колонки в разные цвета, так же крашу исходную карту:

![]({{site.baseurl}}/media/tilemap-test-vertical.png)

Жесть. На Кавказе всё перемешалось: Кабардино-Балкария прилипла к Краснодару, хотя надо было прилипить Карачаево-Черкесию. Ингушетия граничит с Астраханью и Дагестаном, а с Чечнёй — нет. На северо-западе тоже плохо. Надо всё выравнивать заново.

Выравниваю, выравниваю, выравниваю. Не выравнивается. Стоит исправить один косяк, вылезают два других.







<br /><br /><br /><br /><br />
А-а-а-а-а-а! Россия кривая!
**(╯°□°）╯︵ ┻━┻**
<br /><br /><br /><br /><br />






Запоздало придумываю принципы:
- Приграничные субъекты лучше рисовать по краям, остальные — в серединке.
- Чем больше сохранится правильных границ между регионами, тем лучше.
- Особенно важна аккуратность в Центральном федеральном округе.
- Федеральные округа не должны рассыпаться.
- Форма карты должна хотя бы отдалённо напоминать Россию.

Ещё надо по-другому сократить названия субъектов. Никто не догадается, что «Мрл» — республика Марий Эл. Назваю регионы их первыми буквами, короткие названия пишу полностью. Тут тоже не без сюрпризов. Как сократить Краснодар и Красноярск? «Крас» и «Крас»? Решаю иногда делать исключения.

В английской верии с сокращениями регионов будет дико проще, есть официальные.

Снова всё двигаю. Выходит лучше:

![]({{site.baseurl}}/media/tilemap-test-vertical2.png)

Рисую горизонтальные полоски:

![]({{site.baseurl}}/media/tilemap-test-horizontal2.png)

Стало чуть менее криво. Проверяю, не развалились ли округа:

![]({{site.baseurl}}/media/tilemap-test-districts.png)

Северо-Западный федеральный округ порвался, ну и пускай. 

Придумал более наглядный способ оценки качества карты. У каждого квадратика от 0 до 4 соседей. Обозначу эти соседские отношения линиями на исходной карте и получу сетку четырёхугольников. Чем ровнее сетка, тем лучше карта.

![]({{site.baseurl}}/media/tilemap-test-graph1.png)

Сразу видно, что западный Урал задрался наверх.

Другая проблема: восточная часть по форме не похожа на Россию. Исправляю:

![]({{site.baseurl}}/media/tilemap-test-districts2.png)

![]({{site.baseurl}}/media/tilemap-test-graph2.png)

Запад стал лучше. Квадратик Оренбурга ушёл вниз, Ненецкий округ — наверх, проверочная сетка выровнялась. 

На востоке сетка ухудшилась. Алтай и Алтайский край уехали от Кемерово, а Бурятия присоседилась к Еврейскому АО. Но я на это согласен, потому что форма страны стала узнаваемой. Алтай вывалился вниз, как на настоящей карте, и стал дополнительным ориентиром.

Хуже всего то, что Омск между Свердловской областью, Тюменью и Курганом. Хотя на самом деле он восточнее этой тройки. Пробую поменять его местами с Курганом.

![]({{site.baseurl}}/media/tilemap-test-districts3.png)

![]({{site.baseurl}}/media/tilemap-test-graph3.png)

Проверочная сетка разъехалась в районе Омска в тартарары, но зато федеральные округа «расцепились», находить нужные субъекты стало проще.

Если квадратики карты на визуализации залиты полностью, можно сдвинуть половинки карты поближе:

![]({{site.baseurl}}/media/tilemap-test-districts-joined.png)

Если нет заливки, то лучше оставить линию на месте Урала:

![]({{site.baseurl}}/media/tilemap-rect-twosizes3.png)
{: .large}

Готово :–)

Следующий этап — что-нибудь визуализировать. Например, [число аварий на дорогах.](http://stat.gibdd.ru/)
